<%=form_for @blog do |f|%>
  <%= f.text_area :content, :class => "tinymce" %>
  <%= f.submit%>
<%end%>

<script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js"></script>
<script>
  tinymce.init({
    selector: '.tinymce',
    height: 500,
    menubar: false,
    branding: false,
    statusbar : false,
    image_dimensions: false,
    image_description: false,
    plugins: [
      'advlist autolink lists link image charmap print preview anchor',
      'searchreplace visualblocks code fullscreen',
      'insertdatetime media table paste code help wordcount'
    ],
    toolbar: 'undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image',
    // images_upload_url: '/upload_image',
    images_upload_handler: function (blobInfo, success, failure) {
      setTimeout(function(){
        // no matter what you upload we are just showing this for demo
        success('https://homepages.cae.wisc.edu/~ece533/images/airplane.png')
      }, 2000)
      // var xhr, formData;
      // formData = new FormData();
      // formData.append('file', blobInfo.blob(), blobInfo.filename());

      // xhr = new XMLHttpRequest();
      // xhr.withCredentials = false;
      // xhr.open('POST', '/upload_image');

      // xhr.onload = function() {
      //   var json;

      //   if (xhr.status != 200) {
      //     failure('HTTP Error: ' + xhr.status);
      //     return;
      //   }

      //   json = JSON.parse(xhr.responseText);

      //   if (!json || typeof json.url != 'string') {
      //     failure('Invalid JSON: ' + xhr.responseText);
      //     return;
      //   }

      //   success(json.url);
      // };

      // xhr.send(formData);
    }
  });
</script>
